/*!CK:3700151491!*//*1455287021,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["uNWAB"]); }

__d("CrisisSearch",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={SAFE:"safe",UNSAFE:"unsafe",IN_AREA:"in_area"};},null);
__d("CrisisTestIDs",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={IN_AREA_LINK:"inAreaLink",IN_AREA_INSTRUCTIONS:"inAreaInstructions",OUTSIDE_AREA_INSTRUCTIONS:"outsideAreaInstructions",SELF_SAFE_INSTRUCTIONS:"selfSafeInstructions",OTHER_SAFE_INSTRUCTIONS:"otherSafeInstructions",COMPOSER_ROOT:"composerRoot",COMPOSER_MARK_SAFE:"composerMarkSafe",COMPOSER_CONFIRM_SAFE:"composerConfirmSafe",COMPOSER_CLEAR_SAFE:"composerClearSafe",COMPOSER_DECLARE_OUT:"composerDeclareOut",COMPOSER_COMMENT:"composerComment",COMPOSER_SAFE_CHECK:"composerSafeCheck",COMPOSER_UNDO:"composerUndo",MODAL_ROOT:"modalRoot",MODAL_FAKE_STORY:"modalFakeStory",MODAL_REAL_STORY:"modalRealStory",PROFILE_MARK_SAFE:"profileMarkSafe",PROFILE_COMMENT:"profileComment",PROFILE_SAFE_CHECK:"profileSafeCheck",PROFILE_UNDO:"profileUndo",PERMALINK_ROOT:"permalinkRoot",M_PAGE_HEADER:"mPageHeader",PROFILE_LIST:"profileList",IN_AREA_TAB:"inAreaTab",SAFE_TAB:"safeTab",UNSAFE_TAB:"unsafeTab",M_ROOT:"mbasicRoot",M_IN_AREA_FRIEND_LIST:"mbasicInAreaFriendList",M_SAFE_FRIEND_LIST:"mbasicSafeFriendList",M_UNSAFE_FRIEND_LIST:"mbasicUnsafeFriendList",M_SEARCH_RESULT_ROW:"mbasicSearchResultRow",M_SEARCH_FIELD:"mbasicSearchField",M_SEARCH_SUBMIT:"mbasicSearchSubmit",M_SEARCH_RESULTS_CARD:"mbasicSearchResultsCard",M_NO_SEARCH_RESULTS:"mbasicNoSearchResults"};},null);
__d("CrisisUserDeclaredLocation",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={UNKNOWN:0,IN_AREA:1,OUTSIDE_AREA:2};},null);
__d('CrisisCommentLabel.react',['Image.react','React','cx','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=i.PropTypes,n='\u00B7',o=i.createClass({displayName:'CrisisCommentLabel',propTypes:{numComments:m.number},render:function(){var p=k._("Kommentieren"),q;if(this.props.numComments)q=i.createElement('span',null,' '+n+' ',i.createElement(h,{className:"_3dbg",src:l('/images/ufi/fbfeed/comment.png')}),' ',this.props.numComments);return (i.createElement('div',{className:"_3dbh"+(!this.props.numComments?' '+"_3dbi":'')},p,q));}});f.exports=o;},null);
__d('CrisisContent',['CrisisStore','GenderConst','React','fbt'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l={getNumInArea:function(m){return k._({"friend":"{num_friends} FreundIn befindet sich wahrscheinlich in dem betroffenen Gebiet.","friends":"{num_friends} Freunde befinden sich wahrscheinlich in dem betroffenen Gebiet."},[k.param('num_friends',j.createElement('strong',null,m)),k['enum'](m===1?'friend':'friends',{friend:'friend',friends:'friends'})]);},getAllSafe:function(m){return k._("Alle {num_friends} deiner Freunde im Krisengebiet wurden als \u201eIn Sicherheit\u201c markiert.",[k.param('num_friends',j.createElement('strong',null,m))]);},getNumSafe:function(m){return k._({"is":"{num_friends} ist in Sicherheit.","are":"{num_friends} wurden als \u201eIn Sicherheit\u201c markiert."},[k.param('num_friends',j.createElement('strong',null,m)),k['enum'](m===1?'is':'are',{is:'is',are:'are'})]);},getNoFriendsInArea:function(){return k._("Keiner deiner Freunde scheint sich in dem betroffenen Gebiet zu befinden.");},getSelfSafeNUX:function(){return k._("Danke, dass du dich als \u201eIn Sicherheit\u201c markiert hast! Klicke auf den \u201eKommentieren\u201c-Link, um deinen Freunden mehr Informationen zu deinem Status zu geben.");},getSelfSafe:function(){return k._("Du hast dich als \u201eIn Sicherheit\u201c markiert");},getLastPosted:function(m,n){return k._("Zuletzt gepostet {when string, aka 13 hours ago}",[k.param('when string, aka 13 hours ago',j.createElement('a',{href:m},n))]);},getSelfSafeByOther:function(m,n){return k._("Du wurdest von {person who marked safe} als \u201eIn Sicherheit\u201c markiert.",[k.param('person who marked safe',j.createElement('a',{href:n},m))]);},getSelfSafeByOtherShort:function(){return k._("Du wurdest als \u201eIn Sicherheit\u201c markiert.");},getMarkMeSafe:function(){return k._("Ich bin in Sicherheit");},getConfirmSafe:function(){return k._("Ich bin in Sicherheit");},getClearSafe:function(){return k._("Sicherheitsstatus l\u00f6schen");},getMarkSafe:function(){return k._("Als sicher markieren");},getPrivateAffectedDesc:function(){return k._("Du scheinst dich in dem von {crisis_name} betroffenen Gebiet zu befinden. Diese Informationen basieren auf den Orten, in denen du Facebook verwendest. Du hast dies allerdings noch nicht mit deinen Freunden geteilt.",[k.param('crisis_name',h.getName())]);},getSelfDeclaredIn:function(){return k._("Du gibst an, dass du dich in dem betroffenen Gebiet befindest.");},getDeclareOut:function(){return k._("Ich befinde mich nicht in dem Gebiet");},getUndo:function(){return k._("Markierung entfernen");},getComment:function(){return k._("Kommentieren");},getLivesIn:function(m,n){switch(m){default:case i.UNKNOWN:return k._("Sein\/Ihr aktueller Wohnort lautet {city_name}",[k.param('city_name',n)]);case i.MALE_SINGULAR:return k._("Sein aktueller Wohnort lautet {city_name}",[k.param('city_name',n)]);case i.FEMALE_SINGULAR:return k._("Ihr aktueller Wohnort lautet {city_name}",[k.param('city_name',n)]);}},getSelfCurrentCity:function(m){return k._("Dein aktueller Wohnort lautet {city_name}",[k.param('city_name',m)]);},getSelfCurrentlyIn:function(m){return k._("Freunde in der N\u00e4he geben an, dass du dich in {city_name} befindest",[k.param('city_name',m)]);},getCurrentlyIn:function(m,n){switch(m){default:case i.UNKNOWN:return k._("Freunde in der N\u00e4he geben an, dass er\/sie sich in {city_name} befindet",[k.param('city_name',n)]);case i.MALE_SINGULAR:return k._("Freunde in der N\u00e4he geben an, dass er sich in {city_name} befindet",[k.param('city_name',n)]);case i.FEMALE_SINGULAR:return k._("Freunde in der N\u00e4he geben an, dass sie sich in {city_name} befindet",[k.param('city_name',n)]);}},getDeclaredIn:function(m){switch(m){default:case i.UNKNOWN:return k._("Er\/Sie gibt an, dass er\/sie sich in dem betroffenen Gebiet befindet.");case i.MALE_SINGULAR:return k._("Er gibt an, dass er sich in dem betroffenen Gebiet befindet.");case i.FEMALE_SINGULAR:return k._("Sie gibt an, dass sie sich in dem betroffenen Gebiet befindet.");}},getSelfSafeShort:function(m){switch(m.gender){default:case i.UNKNOWN:return k._("Hat sich selbst als \u201eIn Sicherheit\u201c markiert");case i.MALE_SINGULAR:return k._("Hat sich selbst als \u201eIn Sicherheit\u201c markiert");case i.FEMALE_SINGULAR:return k._("Hat sich selbst als \u201eIn Sicherheit\u201c markiert");}},getSelfSafeLabel:function(m){switch(m.gender){default:case i.UNKNOWN:return k._("Hat sich selbst als \u201eIn Sicherheit\u201c markiert");case i.MALE_SINGULAR:return k._("Hat sich selbst als \u201eIn Sicherheit\u201c markiert");case i.FEMALE_SINGULAR:return k._("Hat sich selbst als \u201eIn Sicherheit\u201c markiert");}},getUnaffected:function(){return k._("Befindet sich in dem betroffenen Gebiet");},getDeclaredOut:function(m){switch(m.gender){default:case i.UNKNOWN:return k._("Er\/Sie hat selbst angegeben, dass er\/sie sich nicht in dem betroffenen Gebiet befindet.");case i.MALE_SINGULAR:return k._("Er hat selbst angegeben, dass er sich nicht in dem betroffenen Gebiet befindet.");case i.FEMALE_SINGULAR:return k._("Sie hat selbst angegeben, dass sie sich nicht in dem betroffenen Gebiet befindet.");}},userAffectedByCrisisByline:function(m){return k._("Du scheinst dich in dem von {crisis_name} betroffenen Gebiet zu befinden.",[k.param('crisis_name',m)]);},isViewerSafeQuestionTitle:function(){return k._("Bist du in Sicherheit?");},youAreSafeByline:function(){return k._("Du bist als \u201eIn Sicherheit\u201c markiert.");},inAreaQuestionByline:function(){return k._("Befindest du dich in dem betroffenen Gebiet?");},inAreaCallToActionByline:function(){return k._("Informiere deine Freunde, dass du in Sicherheit bist.");},inAreaButtonText:function(){return k._("Ich befinde mich in dem betroffenen Gebiet");}};f.exports=l;},null);
__d("XCrisisAllSafetyController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/safetycheck\/all_safety\/",{crisis_id:{type:"Int",required:true},mark_safe:{type:"Bool",defaultValue:false},redirect:{type:"Bool",defaultValue:false}});},null);
__d("XCrisisDeclareLocationController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/safetycheck\/declared_location\/",{crisis_id:{type:"Int",required:true},declare_out:{type:"Bool",defaultValue:false},redirect:{type:"Bool",defaultValue:false}});},null);
__d('CrisisComposerMixin',['CrisisContent','CrisisStore','CrisisTestIDs','CrisisUserDeclaredLocation','React','XCrisisAllSafetyController','XCrisisDeclareLocationController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=l.PropTypes,p={propTypes:{userProfile:o.object.isRequired,taggers:o.object.isRequired,cityProfile:o.object.isRequired,isAffected:o.bool.isRequired,isCurrentLocation:o.bool.isRequired,isDeclaredIn:o.bool.isRequired,isDeclaredOut:o.bool.isRequired,isAffectedPrivate:o.bool.isRequired,numComments:o.number},getInitialState:function(){return {taggers:this.props.taggers,loadingDeclare:false,shouldShowSafeNux:false,crisisEnded:false,crisisName:''};},recalculateState:function(){this.setState({crisisName:i.getName(),crisisEnded:i.getIsEnded()});},getDeclareOutURI:function(){return this.getDeclareURI(true);},getDeclareInURI:function(){return this.getDeclareURI(false);},getDeclareURI:function(q){return n.getURIBuilder().setInt('crisis_id',i.getCrisisID()).setBool('declare_out',q).getURI();},getAllSafetyURI:function(q){return m.getURIBuilder().setInt('crisis_id',i.getCrisisID()).setBool('mark_safe',q).getURI();},getInstructionsTestID:function(){if(!this.props.isAffected)return j.OUTSIDE_AREA_INSTRUCTIONS;if(!this.isMarkedSafe())return j.IN_AREA_INSTRUCTIONS;return this.isSelfSafe()?j.SELF_SAFE_INSTRUCTIONS:j.OTHER_SAFE_INSTRUCTIONS;},renderByline:function(){if(this.isSelfSafe()){return this.renderSelfSafe();}else if(this.isMarkedSafe())return this.renderOtherSafe();if(this.props.declaredLocation===k.IN_AREA)return h.getSelfDeclaredIn();if(!this.props.isAffected&&this.props.isAffectedPrivate)return h.getPrivateAffectedDesc();if(this.props.isAffected){var q=this.props.cityProfile.name;return this.props.isCurrentLocation?h.getSelfCurrentlyIn(q):h.getSelfCurrentCity(q);}return null;},isSelfSafe:function(){return !!this.state.taggers[this.props.userProfile.id];},getProfileOfTagger:function(){var q=Object.keys(this.state.taggers);return this.state.taggers[q[0]];},isMarkedSafe:function(){return !!Object.keys(this.state.taggers).length;}};f.exports=p;},null);
__d('CrisisSafeCheck.react',['Image.react','React','XUIText.react','cx','ix','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=i.createClass({displayName:'CrisisSafeCheck',render:function(){return (i.createElement('div',babelHelpers._extends({},this.props,{className:n(this.props.className,"_9cz")}),i.createElement(h,{className:"_js8",src:l('/images/crisis/mobile/check_green_s.png')}),i.createElement(j,{className:"fwb _9c-"},m._("IN SICHERHEIT"))));}});f.exports=o;},null);
__d('LongLiveTimer',['LiveTimer','fbt','LiveTimer'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('LiveTimer').CONSTS,k=24,l=30,m=12,n=babelHelpers._extends({},h);n.parentRenderRelativeTime=n.renderRelativeTime;n.renderRelativeTime=function(o,p,q){var r=this.parentRenderRelativeTime(o,p,q);if(!r.text&&p){var s={text:'',next:-1},t,u=o-p,v=Math.floor(u/j.SEC_IN_MIN),w=Math.floor(v/j.MIN_IN_HOUR),x=Math.floor(w/k),y=Math.floor(x/l),z=Math.floor(y/m);if(w<k){if(q){s.text=i._("{number} h",[i.param('number',w)]);}else s.text=i._({"*":"vor {number} Stunden"},[i.param('number',w,[0])]);s.next=j.SEC_IN_HOUR-u%j.SEC_IN_HOUR;}else if(x<l){if(q){s.text=i._({"*":"{number} d"},[i.param('number',x,[0])]);}else s.text=x==1?i._("vor etwa einem Tag"):i._({"*":"Vor {number} Tagen"},[i.param('number',x,[0])]);t=k*j.SEC_IN_HOUR;s.next=t-u%t;}else if(y<m){if(q){s.text=i._({"*":"{number} M"},[i.param('number',y,[0])]);}else s.text=y==1?i._("vor etwa einem Monat"):i._({"*":"Vor {number} Monaten"},[i.param('number',y,[0])]);t=l*k*j.SEC_IN_HOUR;s.next=t-u%t;}else{if(q){s.text=i._({"*":"{number} y"},[i.param('number',z,[0])]);}else s.text=z==1?i._("vor \u00fcber einem Jahr"):i._({"*":"Vor {number} Jahren"},[i.param('number',z,[0])]);t=m*l*k*j.SEC_IN_HOUR;s.next=t-u%t;}return s;}return r;};f.exports=n;},null);
__d('StoreBasedStateMixin_LEGACY',['SubscriptionsHandler','invariant'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=function(){for(var k=arguments.length,l=Array(k),m=0;m<k;m++)l[m]=arguments[m];!l.length?i(0):undefined;return {componentWillMount:function(){!this.recalculateState?i(0):undefined;this._subscriptions=new h();var n=l.map(function(o){!(o.subscribe||o.addListener)?i(0):undefined;if(o.subscribe){return o.subscribe('change',this.recalculateState);}else return o.addListener('change',this.recalculateState);},this);this._subscriptions.addSubscriptions.apply(this._subscriptions,n);this.recalculateState();},componentWillUnmount:function(){this._subscriptions.release();}};};f.exports=j;},null);
__d("XCrisisUFIController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/safetycheck\/ufi\/",{crisis_id:{type:"Int",required:true},user_id:{type:"Int",required:true},__asyncDialog:{type:"Int"}});},null);
__d('CrisisComposer.react',['Arbiter','AsyncRequest','AsyncResponse','CrisisCommentLabel.react','CrisisComposerMixin','CrisisContent','CrisisSafeCheck.react','CrisisStore','CrisisTestIDs','CrisisViewConstants','Image.react','Layout.react','LeftRight.react','Link.react','LongLiveTimer','React','ReactDOM','ReactFragment','ReactLayeredComponentMixin','ServerRedirect','SimpleNUXMessage','SimpleNUXMessageTypes','StoreBasedStateMixin_LEGACY','SubscriptionsHandler','XCrisisUFIController','XUIAmbientNUX.react','XUIButton.react','XUIGrayText.react','XUISpinner.react','XUIText.react','cx','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma){if(c.__markCompiled)c.__markCompiled();var na=s.Column,oa=s.FillColumn,pa=ca.CRISIS_MARK_SELF_SAFE,qa='\u00B7',ra=w.createClass({displayName:'CrisisComposer',mixins:[l,da(o),z],propTypes:l.propTypes,renderLayers:function(){return {safeNux:w.createElement(ga,{contextRef:(function(){return this.refs.commentLink;}).bind(this),shown:this.state.shouldShowSafeNux,onCloseButtonClick:this.onNuxClose,position:'below'},m.getSelfSafeNUX())};},componentDidMount:function(){this._subs=new ea();this._subs.addSubscriptions(h.subscribe('page_transition',(function(){x.unmountComponentAtNode(x.findDOMNode(this).parentElement);this._subs.release();}).bind(this)));},render:function(){return (w.createElement('div',{'data-testid':p.COMPOSER_ROOT,className:"_4tzx"},this.renderHeader(),w.createElement(s,{className:"_2pi4 _2pit"},w.createElement(na,null,w.createElement('div',{className:"_1qe0"},w.createElement(r,{width:q.COMPOSER_PIC_SIZE,height:q.COMPOSER_PIC_SIZE,src:this.props.userProfile.thumbSrc}))),w.createElement(oa,{className:"_2pi9 _2pic _2pio"},this.renderName(),w.createElement(ia,{className:"_3dgk",shade:'medium',display:'block'},this.renderByline()),this.renderCommentLink()),w.createElement(na,null,this.renderActions()))));},renderHeader:function(){var sa=ma._("Deine Freunde k\u00f6nnen sehen, ob du dich in dem betroffenen Gebiet befindest und werden benachrichtigt, wenn du dich als \u201eIn Sicherheit\u201c markierst.");return (w.createElement(t,{className:"_2ph_ _1qd-"},w.createElement('div',{className:"fwb _3dgl"},ma._("Dein Sicherheitsstatus")),w.createElement(u,{'data-tooltip-alignh':'center','data-hover':'tooltip','aria-label':sa},ma._("Wer wird dies sehen?"))));},renderCommentLink:function(){var sa=fa.getURIBuilder().setInt('crisis_id',o.getCrisisID()).setInt('user_id',this.props.userProfile.id).getURI();return (w.createElement(u,{rel:'dialog-post',href:sa,'data-testid':p.COMPOSER_COMMENT,ref:'commentLink'},w.createElement(k,{numComments:this.props.numComments})));},renderSelfSafe:function(){return y.create({content:m.getSelfSafe(),undo:this.renderUndoMarkSafe()});},renderOtherSafe:function(){var sa=this.getProfileOfTagger(),ta=v.renderRelativeTimeToServer(sa.time_marked),ua=w.createElement('abbr',{'data-utime':sa.time_marked,'data-shorten':true},ta.text);return (w.createElement(ka,null,ma._("Von {person who marked safe} {middot} {when} als \u201eIn Sicherheit\u201c markiert",[ma.param('person who marked safe',w.createElement(u,{target:'_blank',href:sa.uri},sa.name)),ma.param('middot',' '+qa+' '),ma.param('when',ua)])));},renderActions:function(){if(this.state.crisisEnded)return null;var sa;if(this.isSelfSafe()){sa=this.state.loadingSafe?w.createElement(ja,{background:'light',size:'large',className:"_3-91 _3-8x"}):w.createElement(n,{'data-testid':p.COMPOSER_SAFE_CHECK});}else if(this.isMarkedSafe()){sa=y.create({clear:this.renderClearSafety(),confirm:this.renderConfirmSafety()});}else sa=y.create({declare:this.renderDeclareOut(),mark:this.renderMarkSafe()});if(!sa)return null;return (w.createElement(t,{className:"_3dgm"},sa));},renderMarkSafe:function(){return (w.createElement(ha,{'data-testid':p.COMPOSER_MARK_SAFE,disabled:this.state.loadingSafe||this.state.loadingDeclare,use:'special',size:'xlarge',onClick:this.setAllSafety.bind(this,true),label:m.getMarkMeSafe()}));},renderClearSafety:function(){if(this.state.loadingSafe)return (w.createElement(ja,{background:'light',size:'large',className:"_3-93 _3-8x"}));return (w.createElement(u,{className:"_3dgn",onClick:this.setAllSafety.bind(this,false)},m.getClearSafe()));},renderConfirmSafety:function(){return (w.createElement(ha,{disabled:this.state.loadingSafe,use:'special',size:'xlarge',onClick:this.setAllSafety.bind(this,true),label:m.getConfirmSafe()}));},renderUndoMarkSafe:function(){if(this.state.loadingSafe||this.state.crisisEnded)return null;return (w.createElement('span',null,' '+qa+' ',w.createElement(u,{'data-testid':p.COMPOSER_UNDO,onClick:this.setAllSafety.bind(this,false)},m.getUndo())));},renderDeclareOut:function(){if(this.state.loadingDeclare||this.state.loadingSafe)return (w.createElement(ja,{background:'light',size:'large',className:"_3-93 _3-8x"}));return (w.createElement(u,{'data-testid':p.COMPOSER_DECLARE_OUT,className:"_3dgn",onClick:this.declareLocationOut},m.getDeclareOut()));},renderName:function(){return (w.createElement('div',{className:"fwb _1qe3"},this.props.userProfile.name));},setAllSafety:function(sa){this.setState({loadingSafe:true});new i(this.getAllSafetyURI(sa)).setErrorHandler((function(){this.setState({loadingSafe:false});j.defaultErrorHandler.apply(null,arguments);}).bind(this)).setHandler((function(){this.setState({loadingSafe:false});if(!sa){this.setState({taggers:{}});}else{var ta={};ta[this.props.userProfile.id]=babelHelpers._extends({},this.props.userProfile.id,{time_marked:Date.now()/1000});this.setState({taggers:ta});if(!ba.hasUserSeenMessage(pa)){this.setState({shouldShowSafeNux:true});ba.markMessageSeenByUser(pa);}}}).bind(this)).send();},declareLocationOut:function(){this.setState({loadingDeclare:true});new i(this.getDeclareOutURI()).setErrorHandler((function(){this.setState({loadingDeclare:false});for(var sa=arguments.length,ta=Array(sa),ua=0;ua<sa;ua++)ta[ua]=arguments[ua];j.defaultErrorHandler.apply(null,ta);}).bind(this)).setHandler(function(){aa.reloadPage();}).send();},onNuxClose:function(){this.setState({shouldShowSafeNux:false});}});f.exports=ra;},null);
__d("XCrisisSafetyController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/safetycheck\/safety\/",{crisis_id:{type:"Int",required:true},user_id:{type:"Int",required:true},mark_safe:{type:"Bool",defaultValue:false},redirect:{type:"Bool",defaultValue:false},redirect_uri:{type:"String"}});},null);
__d('CrisisProfileMixin',['CrisisStore','CurrentCrisisUser','CrisisContent','React','XCrisisSafetyController','XCrisisUFIController'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n=k.PropTypes,o={propTypes:{userProfile:n.object.isRequired,taggers:n.object.isRequired,cityProfile:n.object.isRequired,isAffected:n.bool.isRequired,isCurrentLocation:n.bool.isRequired,isDeclaredIn:n.bool.isRequired,isDeclaredOut:n.bool.isRequired,everClearedSafety:n.bool.isRequired,lastPostedURL:n.string,lastPostedTime:n.number,numComments:n.number},getInitialState:function(){return {taggers:this.props.taggers,shouldShowSafeNux:false,isAffected:this.props.isAffected,loadingSafe:false,crisisName:'',crisisEnded:false};},recalculateState:function(){this.setState({crisisName:h.getName(),crisisEnded:h.getIsEnded()});},getSafetyURI:function(p){return l.getURIBuilder().setInt('crisis_id',h.getCrisisID()).setInt('user_id',this.props.userProfile.id).setBool('mark_safe',p).getURI();},getUfiURI:function(){return m.getURIBuilder().setInt('user_id',this.props.userProfile.id).setInt('crisis_id',h.getCrisisID()).getURI();},setSafeValue:function(p){var q=this.state.taggers,r=i;if(p){q[r.id]=babelHelpers._extends({},i,{time_marked:Date.now()/1000});}else delete q[r.id];this.setState({taggers:q});},hasViewerMarkedSafe:function(){return !!this.state.taggers[i.id];},getProfileOfTagger:function(){if(this.isSelfSafe())return this.state.taggers[this.props.userProfile.id];var p=Object.keys(this.state.taggers);return this.state.taggers[p[0]];},isSelfSafe:function(){return !!this.state.taggers[this.props.userProfile.id];},canMarkSafe:function(){if(this.props.isDeclaredOut||this.isMarkedSafe()||this.state.crisisEnded||this.props.everClearedSafety)return false;return true;},isMarkedSafe:function(){return !!Object.keys(this.state.taggers).length&&!this.props.isDeclaredOut;},renderByline:function(){if(this.props.isDeclaredOut){return j.getDeclaredOut(this.props.userProfile);}else if(!this.state.isAffected){return j.getUnaffected();}else if(this.isMarkedSafe()){return this.renderAttributionByline();}else if(this.props.isDeclaredIn){return j.getDeclaredIn(this.props.userProfile.gender);}else if(this.props.isCurrentLocation)return j.getCurrentlyIn(this.props.userProfile.gender,this.getCityLink());return j.getLivesIn(this.props.userProfile.gender,this.getCityLink());}};f.exports=o;},null);
__d('CrisisViewActions',['CrisisConstants','CrisisDispatcher','CrisisViewConstants','DOM','$','CrisisStore'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();c('CrisisStore');var m=h.ActionTypes;n.prototype.enterUserSearchMode=function(){i.handleUpdateFromViewAction({actionType:m.ENTER_USER_SEARCH});};n.prototype.updateSearchType=function(o){i.handleUpdateFromViewAction({actionType:m.UPDATE_SEARCH_TYPE,type:o});};n.prototype.decrementMarkSafeCount=function(){i.handleUpdateFromViewAction({actionType:m.CHANGE_MARK_SAFE_COUNT,delta:-1});};n.prototype.incrementMarkSafeCount=function(){i.handleUpdateFromViewAction({actionType:m.CHANGE_MARK_SAFE_COUNT,delta:1});};n.prototype.removeMPagerSafe=function(){var o=k.scry(document.body,'div',j.M_PAGER_ID);if(!o.length)return;k.setContent(l(j.M_PAGER_ID),'');};n.prototype.removePagerSafe=function(){var o=k.scry(document.body,'#'+j.PAGER_ID);if(!o.length)return;k.setContent(l(j.PAGER_ID),'');};function n(){}f.exports=new n();},null);
__d("XCrisisController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/safetycheck\/{?alias}\/",{alias:{type:"String"},crisis_id:{type:"Int"},uid:{type:"Int"},cid:{type:"Int"},search_type:{type:"Enum",enumType:1}});},null);
__d('CrisisProfile.react',['AsyncRequest','AsyncResponse','CrisisContent','CrisisCommentLabel.react','CrisisProfileMixin','CrisisSafeCheck.react','CrisisStore','CrisisTestIDs','CrisisViewActions','CrisisViewConstants','HovercardLink','Image.react','Layout.react','LeftRight.react','LongLiveTimer','Link.react','React','ReactLayeredComponentMixin','SimpleNUXMessage','SimpleNUXMessageTypes','StoreBasedStateMixin_LEGACY','XCrisisController','XUIAmbientNUX.react','XUIButton.react','XUISpinner.react','XUIText.react','XUIGrayText.react','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka){if(c.__markCompiled)c.__markCompiled();var la=t.Column,ma=t.FillColumn,na=aa.CRISIS_MARK_OTHER_SAFE,oa='\u00B7',pa=x.createClass({displayName:'CrisisProfile',mixins:[l,ba(n),y],propTypes:l.propTypes,renderLayers:function(){return {safeNux:x.createElement(da,{contextRef:(function(){return this.refs.name;}).bind(this),shown:this.state.shouldShowSafeNux,onCloseButtonClick:this.onNuxClose,position:'above'},ja._("Danke, dass du {name_of_person} als \u201eIn Sicherheit\u201c markiert hast! Seine\/Ihre Freunde und Familie werden benachrichtigt.",[ja.param('name_of_person',this.props.userProfile.name)]))};},render:function(){return (x.createElement('div',{className:"_4mq5 _2pi9 _2pie"},x.createElement(t,null,x.createElement(la,null,x.createElement('div',{className:"_1br5"},this.renderProfilePic())),x.createElement(ma,{className:"_2pi9 _2pic _2pio"},this.renderName(),x.createElement(ha,{className:"_1br6",shade:'medium',display:'block'},this.renderByline()),this.renderLastStatusInfo(),this.renderCommentLink()),x.createElement(la,{className:"_5y43"},this.renderActions())),x.createElement('div',{className:"_5524"})));},renderLastStatusInfo:function(){if(!this.props.lastPostedURL||!this.props.lastPostedTime)return null;var qa=v.renderRelativeTimeToServer(this.props.lastPostedTime),ra=x.createElement('abbr',{'data-utime':this.props.lastPostedTime,'data-shorten':true},qa.text);return (x.createElement(ha,{className:"_1br6",shade:'medium',display:'block'},j.getLastPosted(this.props.lastPostedURL,ra)));},renderActions:function(){if(this.isMarkedSafe()){return this.state.loadingSafe?x.createElement(fa,{background:'light',size:'large',className:"_3-91"}):x.createElement(m,{'data-testid':o.PROFILE_SAFE_CHECK});}else if(!this.canMarkSafe())return null;var qa=this.state.loadingSafe?x.createElement(fa,{background:'light',size:'large',className:"_3-91"}):null;return (x.createElement(u,null,qa,this.renderMarkSafeButton()));},renderProfilePic:function(){return (x.createElement(w,{className:"_5y42",href:this.props.userProfile.uri,target:'_blank'},x.createElement(s,{width:q.PIC_SIZE,height:q.PIC_SIZE,src:this.props.userProfile.thumbSrc})));},renderName:function(){return this.hovercardWrap(x.createElement('span',{ref:'name',className:"_5whi"},this.props.userProfile.name));},renderUnmarkSafe:function(){if(!this.hasViewerMarkedSafe()||this.state.loadingSafe||this.state.crisisEnded)return null;return (x.createElement('span',null,' '+oa+' ',x.createElement(w,{onClick:this.toggleSafe.bind(this,false),className:'fwl'},j.getUndo())));},getAttributionLabel:function(){var qa=this.getProfileOfTagger(),ra=v.renderRelativeTimeToServer(qa.time_marked),sa=x.createElement('abbr',{'data-utime':qa.time_marked,'data-shorten':true},ra.text),ta;if(this.isSelfSafe()){ta=x.createElement('span',null,j.getSelfSafeLabel(this.props.userProfile),' '+oa+' ',sa);}else{var ua=r.constructEndpoint(qa).toString();ta=x.createElement('span',null,ja._("Von {person who marked safe} als \u201eIn Sicherheit\u201c markiert",[ja.param('person who marked safe',x.createElement(w,{target:'_blank',href:qa.uri,'data-hovercard':ua},qa.name))]),' '+oa+' ',sa);}return ta;},renderAttributionByline:function(){if(this.hasViewerMarkedSafe()){var qa=this.getProfileOfTagger(),ra=v.renderRelativeTimeToServer(qa.time_marked);return (x.createElement(ga,{size:'small'},ja._("Von dir als \u201eIn Sicherheit\u201c markiert"),this.renderUnmarkSafe(),' '+oa+' ',x.createElement('abbr',{'data-utime':qa.time_marked,'data-shorten':true},ra.text)));}return (x.createElement(ga,{size:'small'},this.getAttributionLabel()));},renderMarkSafeButton:function(){return (x.createElement(ea,{'data-testid':o.PROFILE_MARK_SAFE,disabled:this.state.loadingSafe,onClick:this.toggleSafe.bind(this,true),label:j.getMarkSafe()}));},toggleSafe:function(qa){this.setState({loadingSafe:true});new h(this.getSafetyURI(qa)).setErrorHandler((function(){this.setState({loadingSafe:false});i.defaultErrorHandler.apply(null,arguments);}).bind(this)).setHandler((function(){this.setState({loadingSafe:false});if(!this.props.isAffected)this.setState({isAffected:qa});this.setSafeValue(qa);if(qa){p.incrementMarkSafeCount();}else p.decrementMarkSafeCount();if(qa&&!z.hasUserSeenMessage(na)){this.setState({shouldShowSafeNux:true});z.markMessageSeenByUser(na);}}).bind(this)).send();},renderCommentLink:function(){var qa=ca.getURIBuilder().setInt('crisis_id',n.getCrisisID()).setInt('uid',this.props.userProfile.id).getURI();return (x.createElement(w,{rel:'dialog-post','data-testid':o.PROFILE_COMMENT,href:qa,ajaxify:this.getUfiURI()},x.createElement(k,{numComments:this.props.numComments})));},onNuxClose:function(){this.setState({shouldShowSafeNux:false});},getCityLink:function(){var qa=this.props.cityProfile;if(!qa.name||!qa.uri)return ja._("das betroffene Gebiet");var ra=r.constructEndpoint(qa).toString();return (x.createElement(w,{href:qa.uri,'data-hovercard':ra,target:'_blank'},qa.name));},hovercardWrap:function(qa,ra){var sa=r.constructEndpoint(this.props.userProfile).toString();return (x.createElement(w,{className:ka('fwb',ra),href:this.props.userProfile.uri,'data-hovercard':sa,target:'_blank'},qa));}});f.exports=pa;},null);
__d('CrisisResultsColumn.react',['Arbiter','CrisisProfile.react','CrisisStore','React','ReactDOM','PureStoreBasedStateMixin','SubscriptionsHandler','XUISpinner.react','cx'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=k.createClass({displayName:'CrisisResultsColumn',mixins:[m(j)],statics:{calculateState:function(){return {isLoading:j.getIsLoadingProfiles()};}},componentDidMount:function(){this._subs=new n();this._subs.addSubscriptions(h.subscribe('page_transition',(function(){l.unmountComponentAtNode(l.findDOMNode(this).parentElement);this._subs.release();}).bind(this)));},render:function(){if(this.state.isLoading)return (k.createElement('div',{className:"_52jv _2pi1"},k.createElement(o,{size:'large',background:'light'})));var r=j.getSortedProfileProps();r=r.map(function(s){s.key=s.userProfile.id;return k.createElement(i,s);});return (k.createElement('div',null,r));}});f.exports=q;},null);
__d('StoreBasedStateMixin_DEPRECATED',['SubscriptionsHandler','invariant'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=function(){for(var k=arguments.length,l=Array(k),m=0;m<k;m++)l[m]=arguments[m];!l.length?i(0):undefined;return {componentWillMount:function(){!this.calculateState?i(0):undefined;this._subscriptions=new h();var n=(function(){this.setState(this.calculateState());}).bind(this),o=l.map(function(p){if(p.hasChanged&&p.getDispatchToken&&p.addListener){return p.addListener(n);}else if(p.subscribe){return p.subscribe('change',n);}else if(p.addListener){return p.addListener('change',n);}else i(0);},this);this._subscriptions.addSubscriptions.apply(this._subscriptions,o);},componentWillUnmount:function(){this._subscriptions.release();},getInitialState:function(){return this.calculateState();}};};f.exports=j;},null);
__d("XCrisisSearchCountController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/safetycheck\/search_count\/",{crisis_id:{type:"Int",required:true},is_refresh:{type:"Bool",defaultValue:false}});},null);
__d("XCrisisSearchQueryController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/safetycheck\/search\/",{crisis_id:{type:"Int",required:true},page:{type:"Int",required:true},search_type:{type:"String",required:true}});},null);
__d("XCrisisUserSearchController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/safetycheck\/user_search\/",{crisis_id:{type:"Int",required:true},user_id:{type:"Int",required:true}});},null);
__d('CrisisResultsHeader.react',['AsyncRequest','AsyncResponse','CrisisSearch','CrisisStore','CrisisViewActions','LeftRight.react','React','SingleSelectorAlignOnScroll','StoreBasedStateMixin_DEPRECATED','XUISingleSelector.react','XUITypeahead.react','cx','fbt','XCrisisUserSearchController','XCrisisSearchCountController','XCrisisSearchQueryController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){if(c.__markCompiled)c.__markCompiled();var x=n.PropTypes,y=q.Option,z=30*1000,aa=Object.keys(j).map(function(ca){return j[ca];}),ba=n.createClass({displayName:'CrisisResultsHeader',mixins:[p(k)],propTypes:{searchSource:x.object.isRequired,searchedUserID:x.number,searchQuery:x.string,searchType:x.string},getInitialState:function(){return {searchedUserID:this.props.searchedUserID||null,isLoadingCounts:true,hasSent:false,searchQuery:this.props.searchQuery||'',searchType:this.props.searchType};},componentDidMount:function(){this.checkToSend();},checkToSend:function(){if(k.getCrisisID()&&this.state&&!this.state.hasSent)this.sendCountRequest();},calculateState:function(){this.checkToSend();return {crisisID:k.getCrisisID(),numInArea:k.getNumInArea(),numSafe:k.getNumMarkedSafe()};},render:function(){return (n.createElement('div',{className:"_2ph_ _5cml"},n.createElement(m,null,this.renderSelector(),this.renderTypeahead())));},renderSelector:function(){var ca=aa.map((function(da){return (n.createElement(y,{value:da,key:da},this.getLabelForType(da)));}).bind(this));return (n.createElement(q,{behaviors:[o],className:!!this.state.searchedUserID?"_5cmm":'',onShow:this._onSelectShow,onChange:this._onSelect,value:this.state.searchType},ca));},renderTypeahead:function(){return (n.createElement(r,{className:!!this.state.searchedUserID?"_3w_9":'',autoHighlight:true,clearable:true,placeholder:t._("Freunde suchen"),queryString:this.state.searchQuery,searchSource:this.props.searchSource,onChange:this._onSearchChange,onSelectAttempt:this._onSearchSelect,onClear:this._onSearchClear}));},sendCountRequest:function(ca){this.setState({hasSent:true});var da=v.getURIBuilder().setInt('crisis_id',k.getCrisisID()).setBool('is_refresh',!!ca).getURI();new h(da).setErrorHandler((function(){this.setState({isLoading:false});i.defaultErrorHandler.apply(null,arguments);}).bind(this)).setHandler((function(){this.setState({isLoading:false});this.setTimeout();}).bind(this)).send();},setTimeout:function(){setTimeout((function(){if(!this.isMounted())return;this.sendCountRequest(true);}).bind(this),z);},getLabelForType:function(ca){var da;if(this.state.numInArea)da=Math.max(this.state.numInArea-this.state.numSafe,0);switch(ca){case j.SAFE:if(this.state.numSafe){return t._("Freunde in Sicherheit ({num_safe})",[t.param('num_safe',this.state.numSafe)]);}else return t._("Freunde in Sicherheit");break;case j.UNSAFE:if(da){return t._("Noch nicht markierte Freunde ({num_unmarked})",[t.param('num_unmarked',da)]);}else return t._("Noch nicht markierte Freunde");break;case j.IN_AREA:if(this.state.numInArea){return t._("Alle Freunde in dem Gebiet ({num_area})",[t.param('num_area',this.state.numInArea)]);}else return t._("Alle Freunde in dem Gebiet");}return null;},_onSearchClear:function(){this._switchToSearchType(this.state.searchType);},_onSearchSelect:function(ca){if(!k.getCrisisID())return;this.setState({searchedUserID:ca.getUniqueID(),searchQuery:ca.getTitle()});l.enterUserSearchMode();l.removePagerSafe();var da=u.getURIBuilder().setInt('crisis_id',k.getCrisisID()).setInt('user_id',ca.getUniqueID()).getURI();new h(da).send();},_onSearchChange:function(event){this.setState({searchQuery:event.target.value});if(this.state.searchedUserID&&event.target.value==='')this._switchToSearchType(this.state.searchType);},_onSelectShow:function(){this.setState({searchedUserID:null});},_onSelect:function(ca){if(!k.getCrisisID())return;this._switchToSearchType(ca.value);},_switchToSearchType:function(ca){this.setState({searchType:ca,searchedUserID:null,searchQuery:''});l.updateSearchType(ca);l.removePagerSafe();var da=w.getURIBuilder().setInt('crisis_id',k.getCrisisID()).setInt('page',0).setString('search_type',ca).getURI();new h(da).send();}});f.exports=ba;},null);